# 微博爬虫可视化工具使用说明

## 简介

这是一个基于原始微博爬虫项目的可视化界面工具，让普通用户可以通过图形界面轻松配置和运行微博数据爬取任务。

## 功能特点

- 🖥️ **可视化界面**: 友好的图形用户界面，无需命令行操作
- ⚙️ **参数配置**: 可视化配置所有爬虫参数
- 📊 **实时日志**: 实时显示爬取进度和状态
- 💾 **配置管理**: 支持保存和加载配置文件
- 🎯 **一键启动**: 双击即可运行，无需复杂设置

## 安装要求

- Python 3.6+
- 已安装项目依赖包（requirements.txt）

## 快速开始

### 方法一：双击启动（推荐）

1. 双击 `start_gui.bat` 文件
2. 等待程序启动

### 方法二：命令行启动

```bash
python weibo_spider_gui.py
```

## 界面说明

### 基本配置

1. **用户ID列表**: 输入要爬取的微博用户ID，多个ID用逗号分隔
   - 例如：`1669879400,2656274875`
   - 如何获取用户ID请参考原项目文档

2. **时间范围**:
   - **开始日期**: 爬取的起始日期，格式：YYYY-MM-DD
   - **结束日期**: 爬取的结束日期，可填写具体日期或"now"表示当前时间

3. **微博类型**:
   - **全部微博**: 包括原创和转发微博
   - **仅原创**: 只爬取原创微博

### 下载选项

- **下载图片**: 是否下载微博中的图片
- **下载视频**: 是否下载微博中的视频

### 输出格式

支持多种输出格式，可同时选择：
- **CSV**: 表格格式，便于数据分析
- **TXT**: 文本格式，便于阅读
- **JSON**: 结构化数据格式

### Cookie配置

**重要**: Cookie是爬取微博数据的关键，必须正确配置

#### 如何获取Cookie：

1. 打开浏览器，登录微博网页版
2. 按F12打开开发者工具
3. 切换到Network标签
4. 刷新页面
5. 找到任意一个请求，查看Request Headers
6. 复制Cookie字段的值

### 输出目录

选择爬取结果的保存位置，默认为当前目录下的`weibo_data`文件夹。

## 操作流程

1. **配置参数**: 根据需要填写各项配置
2. **设置Cookie**: 输入有效的微博Cookie
3. **选择输出目录**: 指定结果保存位置
4. **开始爬取**: 点击"开始爬取"按钮
5. **查看日志**: 在日志区域实时查看爬取进度
6. **等待完成**: 爬取完成后会显示提示信息

## 配置管理

### 保存配置

1. 配置好所有参数后
2. 点击"保存配置"按钮
3. 选择保存位置和文件名
4. 配置将保存为JSON格式文件

### 加载配置

1. 点击"加载配置"按钮
2. 选择之前保存的配置文件
3. 所有参数将自动填充到界面

## 输出结果

爬取完成后，在指定的输出目录中会生成：

```
weibo_data/
├── 用户昵称1/
│   ├── 用户ID.csv          # 微博数据CSV格式
│   ├── 用户ID.txt          # 微博数据文本格式
│   ├── 用户ID.json         # 微博数据JSON格式（如果选择）
│   ├── img/                # 图片文件夹
│   └── video/              # 视频文件夹
└── 用户昵称2/
    └── ...
```

## 常见问题

### Q: 程序启动失败
A: 请检查Python环境是否正确安装，确保已安装所有依赖包

### Q: 爬取失败或数据为空
A: 通常是Cookie问题，请重新获取有效的Cookie

### Q: 爬取速度很慢
A: 这是正常现象，程序内置了随机等待机制防止被限制

### Q: 被系统限制怎么办
A: 暂停一段时间后重试，或者调整爬取参数降低频率

## 注意事项

1. **遵守法律法规**: 请合理使用爬虫，遵守相关法律法规
2. **尊重网站规则**: 不要过于频繁地请求，避免给服务器造成压力
3. **数据使用**: 爬取的数据仅供学习研究使用，请勿用于商业用途
4. **Cookie安全**: 请妥善保管Cookie信息，不要泄露给他人

## 技术支持

如遇到问题，请参考：
- 原项目GitHub: https://github.com/dataabc/weiboSpider
- 原项目文档中的常见问题解答

## 更新日志

### v1.0.1
- 修复了FLAGS解析错误问题
- 改进了配置文件加载机制
- 增强了错误处理和提示
- 优化了程序启动流程

### v1.0.0
- 初始版本发布
- 支持基本的可视化配置和运行
- 集成原项目的所有核心功能